[Tests]
  design = 'LinearFVAdvection.md LinearFVAdvectionDiffusionOutflowBC.md FVInterpolationMethod.md FVAdvectedUpwind.md FVGeometricAverage.md FVAdvectedVenkatakrishnanDeferredCorrection.md FVAdvectedVanLeerWeightBased.md FVAdvectedMinmodWeightBased.md'
  issues = '#25722 #31965'
  [mms-1d-upwind]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection1DUpwind
    requirement = 'The system shall display first-order convergence for advection problems with upwind interpolation solved using a linear finite volume system on a one-dimensional domain.'
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-1d-linear]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection1DLinear
    requirement = 'The system shall display second-order convergence for advection problems with linear interpolation solved using a linear finite volume system on a one-dimensional domain.'
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-2d-upwind]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection2DUpwind
    requirement = 'The system shall display first-order convergence for advection problems with upwind interpolation solved using a linear finite volume system on a two-dimensional orthogonal mesh.'
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-2d-linear]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection2DLinear
    requirement = 'The system shall display second-order convergence for advection problems with linear interpolation solved using a linear finite volume system on a two-dimensional orthogonal mesh.'
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-2d-upwind-tris]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection2DUpwindTris
    requirement = 'The system shall display first-order convergence for advection problems with upwind interpolation solved using a linear finite volume system on a two-dimensional nonorthogonal mesh.'
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-2d-linear-tris]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection2DLinearTris
    requirement = 'The system shall display first-order convergence for advection problems with linear interpolation solved using a linear finite volume system on a two-dimensional nonorthogonal mesh.'
    # This is first order in the original implementation as well. At some point somebody could take a look at the error terms.
    max_threads = 1 # see libmesh issue #3808
  []
  [mms-2d-rz]
    type = MMSTest
    input = 'test.py'
    test_case = TestAdvection2DRZ
    requirement = 'The system shall display second-order convergence for advection problems with linear interpolation solved using a linear finite volume system on a two-dimensional orthogonal mesh in cylindrical coordinate system.'
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-upwind]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'upwind_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume advection using upwind interpolation on a two-dimensional square domain with diagonal flow and mixed inflow Dirichlet boundaries.'
    cli_args = "Outputs/file_base=upwind LinearFVKernels/advection/advected_interp_method_name=upwind"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-linear]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'average_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume advection using linear (average) interpolation on a two-dimensional square domain with diagonal flow and mixed inflow Dirichlet boundaries.'
    cli_args = "Outputs/file_base=average LinearFVKernels/advection/advected_interp_method_name=average"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-venkat-deferred]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'diagonal-step-2d_out_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume advection using deferred-correction Venkatakrishnan MUSCL interpolation on a two-dimensional square domain with diagonal flow and mixed inflow Dirichlet boundaries.'
    cli_args = "LinearFVKernels/advection/advected_interp_method_name=muscl_venkat Convergence/linear/max_iterations=100"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-vanleer]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'vanleer_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume advection using NVD vanLeer weight-based interpolation on a two-dimensional square domain with diagonal flow and mixed inflow Dirichlet boundaries.'
    cli_args = "Outputs/file_base=vanleer LinearFVKernels/advection/advected_interp_method_name=nvd_vanleer"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-minmod]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'minmod_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume advection using NVD minmod weight-based interpolation on a two-dimensional square domain with diagonal flow and mixed inflow Dirichlet boundaries.'
    cli_args = "Outputs/file_base=minmod LinearFVKernels/advection/advected_interp_method_name=nvd_minmod"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-neg-upwind]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'upwind_neg_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume upwind advection on a two-dimensional square domain for diagonal flow entering from the top-right (velocity -1 -1).'
    cli_args = "Outputs/file_base=upwind_neg LinearFVKernels/advection/advected_interp_method_name=upwind LinearFVKernels/advection/velocity='-1 -1 0' LinearFVBCs/left_inflow/boundary=top LinearFVBCs/bottom_inflow/boundary=right LinearFVBCs/outflow/boundary='left bottom'"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-neg-linear]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'average_neg_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume linear (average) advection on a two-dimensional square domain for diagonal flow entering from the top-right (velocity -1 -1).'
    cli_args = "Outputs/file_base=average_neg LinearFVKernels/advection/advected_interp_method_name=average LinearFVKernels/advection/velocity='-1 -1 0' LinearFVBCs/left_inflow/boundary=top LinearFVBCs/bottom_inflow/boundary=right LinearFVBCs/outflow/boundary='left bottom'"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-neg-venkat-deferred]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'venkat_neg_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume Venkatakrishnan deferred-correction advection on a two-dimensional square domain for diagonal flow entering from the top-right (velocity -1 -1).'
    cli_args = "Outputs/file_base=venkat_neg LinearFVKernels/advection/advected_interp_method_name=muscl_venkat LinearFVKernels/advection/velocity='-1 -1 0' LinearFVBCs/left_inflow/boundary=top LinearFVBCs/bottom_inflow/boundary=right LinearFVBCs/outflow/boundary='left bottom' Convergence/linear/max_iterations=100"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-neg-vanleer]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'vanleer_neg_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume NVD vanLeer weight-based advection on a two-dimensional square domain for diagonal flow entering from the top-right (velocity -1 -1).'
    cli_args = "Outputs/file_base=vanleer_neg LinearFVKernels/advection/advected_interp_method_name=nvd_vanleer LinearFVKernels/advection/velocity='-1 -1 0' LinearFVBCs/left_inflow/boundary=top LinearFVBCs/bottom_inflow/boundary=right LinearFVBCs/outflow/boundary='left bottom'"
    max_threads = 1 # see libmesh issue #3808
  []
  [diagonal-step-2d-neg-minmod]
    type = CSVDiff
    input = diagonal-step-2d.i
    csvdiff = 'minmod_neg_diag_sample_0001.csv'
    requirement = 'The system shall support linear finite volume NVD minmod weight-based advection on a two-dimensional square domain for diagonal flow entering from the top-right (velocity -1 -1).'
    cli_args = "Outputs/file_base=minmod_neg LinearFVKernels/advection/advected_interp_method_name=nvd_minmod LinearFVKernels/advection/velocity='-1 -1 0' LinearFVBCs/left_inflow/boundary=top LinearFVBCs/bottom_inflow/boundary=right LinearFVBCs/outflow/boundary='left bottom'"
    max_threads = 1 # see libmesh issue #3808
  []
[]
